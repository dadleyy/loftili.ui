language: node_js
node_js:
- '0.10'
install:
- gem install sass -v 3.3.14
- gem install bourbon
- gem install neat
- bundle install --path ./vendor/bundle
- bundle exec bitters install --path ./vendor/sass/bitters
- npm install bower -g
- npm install grunt-cli -g
- bower install
- npm install
script:
- echo "building $TRAVIS_COMMIT"
- echo "BUILD_COMMIT=$TRAVIS_COMMIT" > .env
- grunt release
after_success:
- tar -cvzf "loftili-$TRAVIS_COMMIT.tar.gz" ./public/
- curl --ftp-create-dirs -T "loftili-$TRAVIS_COMMIT.tar.gz" -u $FTP_USER:$FTP_PASS "ftp://ftp.sizethreestudios.com/artifacts/loftili/ui/$TRAVIS_COMMIT.tar.gz"
- curl --ftp-create-dirs -T "loftili-$TRAVIS_COMMIT.tar.gz" -u $FTP_USER:$FTP_PASS "ftp://ftp.sizethreestudios.com/artifacts/loftili/ui/latest.tar.gz"
- |
  if [ -n "$TRAVIS_TAG" ]
  then
  curl --ftp-create-dirs -T "loftili-$TRAVIS_COMMIT.tar.gz" -u $FTP_USER:$FTP_PASS "ftp://ftp.sizethreestudios.com/artifacts/loftili/ui/$TRAVIS_TAG.tar.gz"
  else
  echo "not pushing as a tagged build a travis tagged build"
  fi
env:
  global:
  - secure: EP+hO+S5CMxtNT7flMjAG1c2K56g8PtMJ1XNiYSAmyESVKnz1HCtoHFi+5x0sVHQGXKYu18OjV7M6U4CG5PxeFTTBENV9R6MNPoYglgMDoX03VAQjkR5XbO6YqCKyrIAzeOJ4/xx+t+FgfQXAN9+M50QDVpX9OEX3bNzC8z2YyA=
  - secure: bX+JA4H34ddDnQNFkn612X+s2RzNlKv+WJCOcwz7mQWCyEd9C7woRVqQkCfIX2wKjyOh2rA83H3DUCo6PhH32lAgVrbMpdPrDoQHJOVe6uZgeg2KjjzKrJIs1OGg7e/tQv9KdXXn2lMJfL1lcX7pa9uUUgm0NVp/shyxSgVnDso=
  - secure: ClW5L6usMzNheGd/JXn3ENldJcWsskEzSOcxyHAoveRCrZ4BMR0JLgjd4hfKOps9BBIBzJeySZYrCDx8uMbUNfmEVudmXFCqb7ZrWkGJgRLuPuYkpdl4QwMtPZVl2xWUPf4aFXWemsq8SWkM/K5zvrERjuBR66T7me+CYxz1Ylo=
